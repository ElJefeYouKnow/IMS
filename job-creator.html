<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Project Manager</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div>
        <div class="brand">Inventory Management System</div>
        <div class="subtitle">Navigation</div>
        <div class="user-chip">
          <div class="avatar">US</div>
          <div>
            <div style="font-weight:700;">User</div>
            <div style="font-size:12px;opacity:0.8;"></div>
          </div>
        </div>
      </div>
      <nav>
        <a  href="dashboard.html" data-role="admin">Admin Dashboard</a>
        <a  href="employee-dashboard.html" data-role="employee">Dashboard</a>
        <a href="inventory-operations.html">Operations</a>
        <a href="inventory-list.html">Inventory</a>
        <a href="item-master.html" data-role="admin">Item Master</a>
        <a class="active" href="job-creator.html" data-role="admin">Project Manager</a>
        <a href="order-register.html" data-role="admin">Procurement &amp; Allocation</a>
        <a href="field-purchase.html" data-role="employee">Field Purchases</a>

        <a href="settings.html" data-role="admin">Settings</a>
        <a href="settings-employee.html" data-role="employee">Settings</a>
        <a href="item-history.html" data-role="admin">Audit</a>
      </nav>
    </aside>

    <main class="main">
      <header class="topbar">
        <h1>Project Manager</h1>
        <div class="topbar-right"><button id="logoutBtn" class="muted">Logout</button></div>
      </header>

      <section class="card" style="margin-bottom:12px;position:sticky;top:0;z-index:5;">
        <div class="mode-tabs">
          <button class="mode-btn active" data-tab="projects">Projects</button>
          <button class="mode-btn" data-tab="report">Project Report</button>
        </div>
      </section>

      <div id="projects-tab" class="mode-content active">
        <section class="card inventory-card admin-only">
          <h3>Add Project</h3>
          <p class="muted-text">Admin-only: create a project once so every page can reference it consistently.</p>
          <form id="jobForm" class="inventory-form">
            <div class="form-row">
              <label>Project Code<input id="jobCode" required placeholder="Unique project number or name"></label>
              <label>Display Name<input id="jobName" placeholder="Optional friendly name"></label>
              <label>Status
                <select id="jobStatus">
                  <option value="planned">Planned</option>
                  <option value="active">Active</option>
                  <option value="on-hold">On Hold</option>
                  <option value="complete">Complete</option>
                </select>
              </label>
            </div>
            <div class="form-row">
              <label>Start Date<input id="jobStartDate" type="date"></label>
              <label>End Date<input id="jobEndDate" type="date"></label>
              <label>Location<input id="jobLocation" placeholder="Optional site/location"></label>
            </div>
            <div class="form-row">
              <label>Notes<textarea id="jobNotes" rows="3" placeholder="Optional project notes, scope, or instructions"></textarea></label>
            </div>
            <div class="form-row">
              <button type="submit">Save Project</button>
              <button id="jobClearBtn" type="button" class="muted">Clear</button>
            </div>
          </form>
        </section>

        <section class="card">
          <div class="data-toolbar">
            <input id="projectSearchBox" type="text" placeholder="Search by project code or name...">
            <span id="projectCount" class="badge info">-</span>
          </div>
          <table id="projectTable">
            <thead>
              <tr>
                <th>Code</th>
                <th>Name</th>
                <th>Status</th>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Location</th>
                <th>Notes</th>
                <th>Last Updated</th>
                <th id="projectActionsHeader">Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>
      </div>

      <div id="report-tab" class="mode-content">
        <section class="card">
          <div class="summary-grid" style="margin-bottom:12px;">
            <div class="summary-item">
              <span>Total Projects</span>
              <strong id="reportTotalProjects">-</strong>
            </div>
            <div class="summary-item">
              <span>Active Projects</span>
              <strong id="reportActiveProjects">-</strong>
            </div>
            <div class="summary-item">
              <span>Checked Out Units</span>
              <strong id="reportCheckedOut">-</strong>
            </div>
            <div class="summary-item">
              <span>Reserved Units</span>
              <strong id="reportReserved">-</strong>
            </div>
          </div>
          <div class="data-toolbar">
            <input id="reportSearchBox" type="text" placeholder="Search by project, status, or location...">
            <select id="reportStatusFilter">
              <option value="">All Statuses</option>
              <option value="planned">Planned</option>
              <option value="active">Active</option>
              <option value="on-hold">On Hold</option>
              <option value="complete">Complete</option>
            </select>
            <input id="reportLocationFilter" type="text" placeholder="Filter by location...">
            <select id="reportWindowFilter">
              <option value="">All Dates</option>
              <option value="upcoming7">Start within 7 days</option>
              <option value="upcoming30">Start within 30 days</option>
              <option value="overdue">End date passed</option>
              <option value="missingDates">Missing dates</option>
            </select>
            <label class="filter-chip"><input id="reportIncludeGeneral" type="checkbox" checked> Include General</label>
            <label class="filter-chip"><input id="reportHasActivity" type="checkbox"> With activity only</label>
            <button id="reportExpandAll" type="button" class="muted">Expand All</button>
            <button id="reportExportBtn" type="button" class="muted">Export CSV</button>
          </div>
          <table id="reportTable">
            <thead>
              <tr>
                <th>Project</th>
                <th>Status</th>
                <th>Start</th>
                <th>End</th>
                <th>Location</th>
                <th>On Hand</th>
                <th>Checked Out</th>
                <th>Reserved</th>
                <th>Net Usage</th>
                <th>Items</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>
      </div>
    </main>
  </div>

  <div id="jobEditModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="jobEditTitle">
    <div class="modal-content">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <h3 id="jobEditTitle" style="margin:0;">Edit Project</h3>
        <button id="jobEditClose" class="muted" type="button">Close</button>
      </div>
      <p id="jobEditMeta" class="muted-text">Editing project:</p>
      <form id="jobEditForm" class="inventory-form">
        <div class="form-row">
          <label>Project Code<input id="jobEditCode" required readonly></label>
          <label>Display Name<input id="jobEditName" placeholder="Optional friendly name"></label>
          <label>Status
            <select id="jobEditStatus">
              <option value="planned">Planned</option>
              <option value="active">Active</option>
              <option value="on-hold">On Hold</option>
              <option value="complete">Complete</option>
            </select>
          </label>
        </div>
        <div class="form-row">
          <label>Start Date<input id="jobEditStartDate" type="date"></label>
          <label>End Date<input id="jobEditEndDate" type="date"></label>
          <label>Location<input id="jobEditLocation" placeholder="Optional site/location"></label>
        </div>
        <div class="form-row">
          <label>Notes<textarea id="jobEditNotes" rows="3" placeholder="Optional project notes, scope, or instructions"></textarea></label>
        </div>
        <div class="modal-actions">
          <button type="submit">Update Project</button>
          <button id="jobEditCancel" type="button" class="muted">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script src="js/utils.js"></script>
  <script src="js/job-creator.js"></script>
  <script>document.addEventListener('DOMContentLoaded',()=>{if(window.utils){utils.wrapFetchWithRole?.();utils.applyStoredTheme?.();utils.applyNavVisibility?.();utils.setupLogout?.();}});</script>
</body>
</html>


